@page
@model ModernWebGoat.Pages.Vulnerabilities.SearchModel
@{
    ViewData["Title"] = "Reflected XSS - Search";
}

<h2>Site Search <span class="badge badge-red">A05</span></h2>
<p style="color: var(--text-muted);">Search the site. The query is reflected directly into the page without encoding.</p>

<div class="alert alert-warning">
    <strong>Hint:</strong> Try searching for <code>&lt;script&gt;alert('XSS')&lt;/script&gt;</code> or <code>&lt;img src=x onerror=alert(1)&gt;</code>
</div>

<form method="get" style="display: flex; gap: 0.5rem; margin-bottom: 1rem;">
    <div class="form-group" style="flex: 1; margin-bottom: 0;">
        <input type="text" name="Query" value="@Model.Query" placeholder="Search..." />
    </div>
    <button type="submit" class="btn">Search</button>
</form>

@if (!string.IsNullOrEmpty(Model.Query))
{
    <div class="card">
        <h3>Search Results</h3>
        <!-- VULNERABILITY A05: Reflected XSS â€” Html.Raw renders user input without encoding -->
        <p>You searched for: @Html.Raw(Model.Query)</p>
        <p style="color: var(--text-muted);">No results found.</p>
    </div>
}
